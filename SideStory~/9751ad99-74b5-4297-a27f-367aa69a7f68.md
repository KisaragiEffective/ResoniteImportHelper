# 無題_9751ad99-74b5-4297-a27f-367aa69a7f68
この記事は[Resoniteアドカレ1枚目](https://adventar.org/calendars/10543)5日目の記事です。

## なぜRIHを作ったのか
なぜ私がResoniteImportHelper、略してRIHを作ったのかは今まであまり説明してこなかったことだと思うので、これを機に説明します。

「前」からの慣例として、Resoniteに初めて来た人や新しくアバターをセットアップする人は専用ワールドでセットアップしたものでした。
しかし、私はそれを是としませんでした。なぜなら、必要な行程ではあるもののセットアップの手間がVRChatのそれとはかけ離れているからです。
VRChatでは、Unityというゲームエンジンを開き、ZIPもどき[^1]を解凍すると一発で使えるアバターが置かれていることがほとんどです。そして、それを編集する際にはUnityで編集してからサーバーにアップロードします。
一方のResoniteではどうでしょうか。親切なショップであれば同等の役割を果たすresonitepackageが同梱されていることがありますが、ほとんどはそうではありません。そこで、通常はFBXやVRMなどの汎用モデル形式をインポートすることになります。
しかし、多くの場合でテクスチャの参照が壊れているため、メインテクスチャ、ノーマルマップ、マットキャップといったあらゆるテクスチャをもう一度割り当てる必要があります。これが第一の関門です。いくら必須の操作とはいえ、早い段階でこれを要求するのは厳しいものがあると主張します。
しかし、慣れている既存ユーザーに委託するのにも解決が難しい問題があります。
まず、引き受けてくれる人を探さなければならないことです。私のようにコミュニケーションが上手ではないユーザーや、一人で過ごしたいがwikiの翻訳が追いついていないためにキャッチアップすることが難しいユーザーは厳しい決断を迫られていると考えています。
また、ライセンス上の問題も存在します。以前、「アバター界隈」で広く用いられているVN3ライセンスの改訂案を募集していたため、他人によるセットアップを他人への改変委託から分離してはどうか、と意見を書き込みましたが、モデラーを対象にした過去のアンケートによる結果及びresonite自体がモデラーに知られていないことにより却下されました。あまり意識されない観点ではありますが、これが第二の壁です。
それが終わると今度は表情やらギミックやらの再現が必要になるでしょう。幸い、VRChatでエンコードできるのは有限のメモリなので、チューリング完全ではありません。しかし、完全に同期させるとなるとやはりインスペクタを触ったりProtofluxに手を出したりする必要があります。これが第三の壁です。


[^1]: unitypackageのこと。Resonite用語き翻訳するとresonitepackageのこと。

* 人に依存するセットアップワークフローが嫌だったから
    * 例えば、丑三つ時にセットアップしたくなってもできませんね？
        * できる ← まあそうだね、ところで私はdev tooltipをもってインスペクタを開いてテクスチャをいちいち割り当てるのは苦行だと思います
* Resoniteで着替えさせるのがめんどくさい (はず)
    * ツッコミまち: 少なくとも自分はそのようなツールを知らない
* VRMが使えないから
    * 正確には、glTFは読み込めるがMToonなどのVRM拡張部分が読めない
* 手動作業が面倒だから
    * NDMF Manual Bakeして、UniGLTFでエクスポートして、シェーダーをいい感じに見比べて、違ってたら修正して……なんてやってられるかーーーー！！！
    * 決まりきったワークフローを手動でやるのはミスの元だし時間の無駄
* 表情作るのがちょっと面倒
    * モデルをインポートしたときにシェイプキーの初期値が読み込まれないことがある
* 今流行りの非破壊改変と相性が悪い
    * 一部はProtoFluxでエミュレートできるが、アバターの構成要素を全て操作できるわけではない
* IK探知が勘違いする
    * 例えば"ChestBelt"というボーンが胸だと認識されてリグがおかしくなるとか、そういうの

これらはRIHでほぼ解決します。

* 人に依存するセットアップワークフロー → かなりの軽減
* Resoniteで着替えさせるのがめんどくさい → それなりに軽減
* VRMが使えない → いい感じにそれっぽいプロパティをglTFに押し込めることで強引に解決
* 手動作業が面倒 → 手動作業を破壊
* 表情作るのがちょっと面倒 → 今は解決しない
* 今流行りの非破壊改変と相性が悪い → NDMFとVRCSDKのホックに対応して解決
* IK探知が勘違いする → `<NoIK>` をつけて解決

## むすび
ありがたいことに月々いくらかの支援を頂いているので、今後も実装できる範囲でメンテナンスを続けていくつもりです。

明日は〇〇さんの『〜』です、お楽しみに！

